@model GameIndexViewModel

@{
    ViewData["Title"] = "Jeux";
}
<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css"/>
<h1>Liste des jeux</h1>

<form method="get" asp-action="Index" class="row g-3 mb-3">
    <div class="col-md-3">
        <label for="categoryId" class="form-label">Catégorie</label>
        <select id="categoryId" name="categoryId" class="form-select">
            <option value="">Toutes</option>
            @{
                var selectedId = Model.SelectedCategory;
            }
            @foreach (var c in Model.Categories)
            {
                <option value="@c.Id"
                        selected="@(selectedId.HasValue && selectedId.Value == c.Id ? "selected" : null)">@c.Libelle</option>
            }
        </select>
    </div>
    <div class="col-md-2">
        <label for="minPrice" class="form-label">Prix min</label>
        <input type="number" step="1" min="0" id="minPrice" name="minPrice" class="form-control"
               value="@(Model.MinPrice?.ToString() ?? string.Empty)"/>
    </div>
    <div class="col-md-2">
        <label for="maxPrice" class="form-label">Prix max</label>
        <input type="number" step="1" min="0" max="@Model.GlobalMaxPrice.ToString()" id="maxPrice" name="maxPrice"
               class="form-control" value="@(Model.MaxPrice?.ToString() ?? string.Empty)"/>
    </div>
    <div class="col-md-3">
        <label for="search" class="form-label">Rechercher par nom</label>
        <input type="text" id="search" name="search" class="form-control" value="@(Model.Search ?? string.Empty)"
               placeholder="Nom du jeu..."/>
    </div>
    <div class="col-md-2 d-flex align-items-end">
        <button type="submit" class="btn btn-primary w-100">Filtrer</button>
    </div>
</form>

<table class="table">
    <thead>
    <tr>
        <th>Id</th>
        <th>Nom</th>
        <th>Description</th>
        <th>Prix</th>
        <th>Catégories</th>
    </tr>
    </thead>
    <tbody>
    @foreach (var g in Model.Games)
    {
        <tr>
            <td>@g.Id</td>
            <td>@g.Name</td>
            <td>@g.Description</td>
            <td>@g.Price.ToString("C")</td>
            <td>@string.Join(", ", g.Categories.Select(c => c.Libelle))</td>
        </tr>
    }
    </tbody>
</table>